<form #patientForm="ngForm">
<div style="height:100%;width:100%;">
  <div style=" width: 50%">
    <h4 style="margin-left: 5%">Patientendaten eingeben:</h4>
    <app-patient-fields (fieldEvent)="fieldsChanged($event)"
                        [fields]="patient.fields"></app-patient-fields>
    <br>
    <div style="width: 90%; margin-left: 5%; max-width: 700px;">
      <h4>Externes Pseudonym hinzufügen:</h4>
      <app-external-pseudonyms [readOnly]="false" [ids]="this.patient.ids" [removeEmptyId]="true"></app-external-pseudonyms>
    </div>
    <br>
    <div style="width: 90%; margin-left: 5%; max-width: 700px;" ngModelGroup="internalIdTypes"
         #internalIdTypesModelGroup="ngModelGroup">
      <h4>Pseudonymtyp hinzufügen:</h4>
      <mat-form-field color="primary" style="width: 76.5%">
        <mat-label>Pseudonym-Typen</mat-label>
        <mat-chip-list #chipList aria-label="Fruit selection"
                       name="internalIdTypesChipList"
                       [ngModel]="this.selectedInternalIdTypes.join(',')"
                       required>
          <mat-chip *ngFor="let idType of this.selectedInternalIdTypes"
                    [selectable]="true"
                    [removable]="true"
                    (removed)="removeInternalIdType(idType)">
            {{idType}}
            <button matChipRemove>
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip>
          <input [formControl]="chipListInputCtrl"
                 [matChipInputFor]="chipList"
                 [matAutocomplete]="auto"
                 [matChipInputAddOnBlur]="true"
                 (matChipInputTokenEnd)="findAndAddInternalIdType($event)">
        </mat-chip-list>
        <mat-error>Die Eingabe des Pseudonymtyps ist erforderlich</mat-error>
        <mat-autocomplete #auto="matAutocomplete"
                          (optionSelected)="selectedInternalIdType($event)">
          <mat-option style="height: auto" *ngFor="let idType of this.filteredInternalIdTypes | async"
                      [value]="idType.idType">
            <div [hidden]="idType.added">{{idType.idType}}</div>
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
      <br>
    </div>
    <br>
    <div>
      <div style="margin-left: 5%;">
        <button *ngIf="!consent" style="float: left;" mat-raised-button (click)="openConsentDialog()">
          <mat-icon>add</mat-icon>Einwilligung Hinzufügen
        </button>
        <button *ngIf="consent" style="float: left;" mat-raised-button (click)="openConsentDialog()">
          <mat-icon>edit</mat-icon>{{consent.title}}
        </button>
      </div>
    </div>
    <br>
    <button mat-raised-button class="submit" style="margin-left: 5%; width: 20%; float: left;"
            [disabled]="this.disable(patientForm)"
            (click)="createNewPatient(false)">Anfordern
    </button>
  </div>
</div>
</form>
